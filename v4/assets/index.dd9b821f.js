import{a as V,T as at}from"./index.eb166e5b.js";import{c as K,L as lt,b as ut,i as dt,n as j,N as ft,J as L,r as R,y as ht,x as Q,l as mt,u as pt,e as xt,v as gt,a as vt}from"./use-translate.5fa8a2a1.js";import{t as yt,n as Z,a as Tt,w as G}from"./with-install.ff23f643.js";import{u as Ct}from"./use-touch.ecfb8eef.js";import{u as W}from"./use-expose.840221e5.js";import{A as B,u as A,D as O,M as St,x as F,e as c,S as bt,Q as kt,q as At,H as It,o as _,c as _t,w as C,C as n,a as H,b as U,d as X,F as Y,h as wt,t as Lt}from"./vue-libs.ed3d9812.js";import{f as Rt}from"./constant.80c6de18.js";import{C as S}from"./index.64e1751e.js";import"./use-id.6401ef5b.js";import"./use-route.24f31c45.js";import"./index.79003321.js";import"./on-popup-reopen.08d2a38f.js";import"./interceptor.f92ff708.js";import"./use-refs.abd3b4ec.js";import"./index.049f3457.js";import"./index.0f47b777.js";import"./index.dc9079c8.js";function Ot(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!kt(e)}function Bt(){const e="A".charCodeAt(0);return Array(26).fill("").map((s,d)=>String.fromCharCode(e+d))}const[tt,w]=K("index-bar"),Et={sticky:yt,zIndex:Z,teleport:[String,Object],highlightColor:String,stickyOffsetTop:Tt(0),indexList:{type:Array,default:Bt}},et=Symbol(tt),Pt=B({name:tt,props:Et,emits:["select","change"],setup(e,{emit:r,slots:s}){const d=A(),p=A(),g=A(""),h=Ct(),f=lt(d),{children:o,linkChildren:b}=ut(et);let m;b({props:e});const ot=O(()=>{if(dt(e.zIndex))return{zIndex:+e.zIndex+1}}),nt=O(()=>{if(e.highlightColor)return{color:e.highlightColor}}),E=(t,i)=>{for(let a=o.length-1;a>=0;a--){const u=a>0?i[a-1].height:0,l=e.sticky?u+e.stickyOffsetTop:0;if(t+l>=i[a].top)return a}return-1},P=t=>o.find(i=>String(i.index)===t),I=()=>{if(ft(d))return;const{sticky:t,indexList:i}=e,a=L(f.value),u=R(f),l=o.map(T=>T.getRect(f.value,u));let v=-1;if(m){const T=P(m);if(T){const y=T.getRect(f.value,u);v=E(y.top,l)}}else v=E(a,l);g.value=i[v],t&&o.forEach((T,y)=>{const{state:x,$el:rt}=T;if(y===v||y===v-1){const k=rt.getBoundingClientRect();x.left=k.left,x.width=k.width}else x.left=null,x.width=null;if(y===v)x.active=!0,x.top=Math.max(e.stickyOffsetTop,l[y].top-a)+u.top;else if(y===v-1&&m===""){const k=l[v].top-a;x.active=k>0,x.top=k+u.top-l[y].height}else x.active=!1}),m=""},N=()=>{At(I)};j("scroll",I,{target:f,passive:!0}),St(N),F(()=>e.indexList,N),F(g,t=>{t&&r("change",t)});const st=()=>e.indexList.map(t=>{const i=t===g.value;return c("span",{class:w("index",{active:i}),style:i?nt.value:void 0,"data-index":t},[t])}),$=t=>{m=String(t);const i=P(m);if(i){const a=L(f.value),u=R(f),{offsetHeight:l}=document.documentElement;if(i.$el.scrollIntoView(),a===l-u.height){I();return}e.sticky&&e.stickyOffsetTop&&ht(Q()-e.stickyOffsetTop),r("select",i.index)}},D=t=>{const{index:i}=t.dataset;i&&$(i)},it=t=>{D(t.target)};let z;const ct=t=>{if(h.move(t),h.isVertical()){mt(t);const{clientX:i,clientY:a}=t.touches[0],u=document.elementFromPoint(i,a);if(u){const{index:l}=u.dataset;l&&z!==l&&(z=l,D(u))}}},M=()=>c("div",{ref:p,class:w("sidebar"),style:ot.value,onClick:it,onTouchstartPassive:h.start},[st()]);return W({scrollTo:$}),j("touchmove",ct,{target:p}),()=>{var i;let t;return c("div",{ref:d,class:w()},[e.teleport?c(bt,{to:e.teleport},Ot(t=M())?t:{default:()=>[t]}):M(),(i=s.default)==null?void 0:i.call(s)])}}}),q=G(Pt),[Nt,$t]=K("index-anchor"),Dt={index:Z},zt=B({name:Nt,props:Dt,setup(e,{slots:r}){const s=It({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),d=A(),{parent:p}=pt(et);if(!p)return;const g=()=>s.active&&p.props.sticky,h=O(()=>{const{zIndex:o,highlightColor:b}=p.props;if(g())return xt(gt(o),{left:s.left?`${s.left}px`:void 0,width:s.width?`${s.width}px`:void 0,transform:s.top?`translate3d(0, ${s.top}px, 0)`:void 0,color:b})});return W({state:s,getRect:(o,b)=>{const m=R(d);return s.rect.height=m.height,o===window||o===document.body?s.rect.top=m.top+Q():s.rect.top=m.top+L(o)-b.top,s.rect}}),()=>{const o=g();return c("div",{ref:d,style:{height:o?`${s.rect.height}px`:void 0}},[c("div",{style:h.value,class:[$t({sticky:o}),{[Rt]:o}]},[r.default?r.default():e.index])])}}}),J=G(zt),oe=B({__name:"index",setup(e){const r=vt({"zh-CN":{text:"\u6587\u672C",customIndexList:"\u81EA\u5B9A\u4E49\u7D22\u5F15\u5217\u8868"},"en-US":{text:"Text",customIndexList:"Custom Index List"}}),s=A(0),d=[],p=[1,2,3,4,5,6,8,9,10],g="A".charCodeAt(0);for(let h=0;h<26;h++)d.push(String.fromCharCode(g+h));return(h,f)=>(_(),_t(n(at),{active:s.value,"onUpdate:active":f[0]||(f[0]=o=>s.value=o)},{default:C(()=>[c(n(V),{title:n(r)("basicUsage")},{default:C(()=>[c(n(q),null,{default:C(()=>[(_(),H(Y,null,U(d,o=>X("div",{key:o},[c(n(J),{index:o},null,8,["index"]),c(n(S),{title:n(r)("text")},null,8,["title"]),c(n(S),{title:n(r)("text")},null,8,["title"]),c(n(S),{title:n(r)("text")},null,8,["title"])])),64))]),_:1})]),_:1},8,["title"]),c(n(V),{title:n(r)("customIndexList")},{default:C(()=>[c(n(q),{"index-list":p},{default:C(()=>[(_(),H(Y,null,U(p,o=>X("div",{key:o},[c(n(J),{index:o},{default:C(()=>[wt(Lt(n(r)("title")+o),1)]),_:2},1032,["index"]),c(n(S),{title:n(r)("text")},null,8,["title"]),c(n(S),{title:n(r)("text")},null,8,["title"]),c(n(S),{title:n(r)("text")},null,8,["title"])])),64))]),_:1})]),_:1},8,["title"])]),_:1},8,["active"]))}});export{oe as default};
